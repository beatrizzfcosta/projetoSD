<!DOCTYPE html>
<html lang="pt" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin - Classic Cars</title>
    <link rel="stylesheet" th:href="@{/css/admin-style.css}" />
    <link rel="stylesheet" th:href="@{/css/style.css}"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
<div class="admin-container">
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>Admin Panel</h2>
            <h1 class="collapsed-title">AC</h1>
            <button class="toggle-sidebar" id="toggleSidebar">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        <ul class="sidebar-menu">
            <li><a href="#dashboard" class="active"><i class="fas fa-chart-line"></i><span>Dashboard</span></a></li>
            <li><a href="#carros-comprados"><i class="fas fa-car"></i><span>Carros Comprados</span></a></li>
            <li><a href="#carros-stock"><i class="fas fa-warehouse"></i><span>Carros em Stock</span></a></li>
            <li><a href="#novo-carro"><i class="fas fa-plus-circle"></i><span>Novo Carro</span></a></li>
            <li><a href="#graficos"><i class="fas fa-chart-bar"></i><span>Gráficos</span></a></li>
            <li><a href="/" class="store-link"><i class="fas fa-store"></i><span>Ir para a Loja</span></a></li>
            <li><a href="/"><i class="fas fa-sign-out-alt"></i><span>Sair</span></a></li>
        </ul>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Dashboard Section -->
        <section id="dashboard" class="section">
            <h2>Dashboard</h2>
            <div class="stats-cards">
                <div class="stat-card">
                    <h3>Total de Vendas</h3>
                    <div class="value">€ 1.250.000</div>
                </div>
                <div class="stat-card">
                    <h3>Carros em Estoque</h3>
                    <div class="value">24</div>
                </div>
                <div class="stat-card">
                    <h3>Usuários Ativos</h3>
                    <div class="value">156</div>
                </div>
                <div class="stat-card">
                    <h3>Pedidos Pendentes</h3>
                    <div class="value">8</div>
                </div>
            </div>
        </section>

        <!-- Carros Comprados Section -->
        <section id="carros-comprados" class="section">
            <h2>Carros Comprados</h2>
            <div class="filters">
                <div class="filter-group">
                    <label>Data de Compra</label>
                    <input type="date">
                </div>
                <div class="filter-group">
                    <label>Valor</label>
                    <select>
                        <option value="">Todos</option>
                        <option value="0-50000">Até €50.000</option>
                        <option value="50000-100000">€50.000 - €100.000</option>
                        <option value="100000+">Acima de €100.000</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Nome do Carro</label>
                    <input type="text" placeholder="Pesquisar...">
                </div>
                <div class="filter-group">
                    <label>Nome do Cliente</label>
                    <input type="text" placeholder="Pesquisar cliente...">
                </div>
            </div>
            <div class="table-container">
                <table class="data-table">
                    <thead>
                    <tr>
                        <th>ID</th>
                        <th>Carro</th>
                        <th>Data de Compra</th>
                        <th>Valor</th>
                        <th>Cliente</th>
                        <th>Status</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="id-cell">#001</td>
                        <td>Porsche 911</td>
                        <td>15/03/2024</td>
                        <td class="price-cell">€230.000</td>
                        <td>João Silva</td>
                        <td><span class="status-badge status-completed">Entregue</span></td>
                    </tr>
                    <tr>
                        <td class="id-cell">#002</td>
                        <td>BMW M3</td>
                        <td>10/03/2024</td>
                        <td class="price-cell">€180.000</td>
                        <td>Maria Santos</td>
                        <td><span class="status-badge status-pending">Em Processamento</span></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Carros em Stock Section -->
        <section id="carros-stock" class="section">
            <h2>Carros em Stock</h2>
            <div class="filters">
                <div class="filter-group">
                    <label>Quilometragem</label>
                    <select>
                        <option value="">Todos</option>
                        <option value="0-50000">Até 50.000 km</option>
                        <option value="50000-100000">50.000 - 100.000 km</option>
                        <option value="100000+">Acima de 100.000 km</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Preço</label>
                    <select>
                        <option value="">Todos</option>
                        <option value="0-50000">Até €50.000</option>
                        <option value="50000-100000">€50.000 - €100.000</option>
                        <option value="100000+">Acima de €100.000</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Ano</label>
                    <select>
                        <option value="">Todos</option>
                        <option value="1950-1960">1950 - 1960</option>
                        <option value="1960-1970">1960 - 1970</option>
                        <option value="1970-1980">1970 - 1980</option>
                        <option value="1980-1990">1980 - 1990</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Transmissão</label>
                    <select>
                        <option value="">Todas</option>
                        <option value="manual">Manual</option>
                        <option value="automatico">Automático</option>
                    </select>
                </div>
            </div>
            <div class="table-container">
                <table class="data-table">
                    <thead>
                    <tr>
                        <th>ID</th>
                        <th>Modelo</th>
                        <th>Ano</th>
                        <th>Quilometragem</th>
                        <th>Preço</th>
                        <th>Transmissão</th>
                        <th>Ações</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="id-cell">#001</td>
                        <td>Porsche 911</td>
                        <td>1964</td>
                        <td>45.000 km</td>
                        <td class="price-cell">€230.000</td>
                        <td>Manual</td>
                        <td class="action-buttons">
                            <button class="action-btn edit-btn"><i class="fas fa-edit"></i></button>
                            <button class="action-btn delete-btn"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                    <tr>
                        <td class="id-cell">#002</td>
                        <td>BMW M3</td>
                        <td>1986</td>
                        <td>60.000 km</td>
                        <td class="price-cell">€180.000</td>
                        <td>Automático</td>
                        <td class="action-buttons">
                            <button class="action-btn edit-btn"><i class="fas fa-edit"></i></button>
                            <button class="action-btn delete-btn"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Novo Carro Section -->
        <section id="novo-carro" class="section" style="display: block;">
            <h2>Adicionar Novo Carro</h2>
            <form th:action="@{/admin/product/add}" th:object="${productForm}" method="post" class="car-form" id="novoCarroForm">
                <div class="form-grid">
                    <!-- Informações Básicas -->
                    <div class="form-section">
                        <h3>Informações Básicas</h3>
                        <div class="form-group">
                            <label for="nome">Nome do Carro*</label>
                            <input type="text" id="nome" th:field="*{name}" required />
                        </div>
                        <div class="form-group">
                            <label for="descricao">Descrição</label>
                            <textarea id="descricao" th:field="*{description}" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="preco">Preço (€)*</label>
                            <input type="number" id="preco" th:field="*{price}" step="0.01" required />
                        </div>
                        <div class="form-group">
                            <label for="portas">Número de Portas*</label>
                            <input type="number" id="portas" th:field="*{doorCount}" min="2" max="5" required />
                        </div>
                    </div>

                    <!-- Categorização -->
                    <div class="form-section">
                        <h3>Categorização</h3>
                        <div class="form-group">
                            <label for="marca">Marca*</label>
                            <select id="marca" th:field="*{brandId}" required>
                                <option value="">Selecione uma Marca</option>
                                <option th:each="brand : ${ListBrands}"
                                        th:value="${brand.brandId}"
                                        th:text="${brand.brandName}">
                                </option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="typeId">Tipo*</label>
                            <select id="typeId" th:field="*{typeId}" required>
                                <option value="">Selecione um tipo</option>
                                <option th:each="type : ${ListType}"
                                        th:value="${type.typeId}"
                                        th:text="${type.typeName}">
                                </option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="colorId">Cor*</label>
                            <select id="colorId" th:field="*{colorId}" required>
                                <option value="">Selecione uma cor</option>
                                <option th:each="color : ${ListColors}"
                                        th:value="${color.colorId}"
                                        th:text="${color.colorName}">
                                </option>
                            </select>
                        </div>
                    </div>

                    <!-- Imagem -->
                    <div class="form-section">
                        <h3>Imagem do Carro</h3>
                        <div class="form-group">
                            <label for="imagem">URL da Imagem*</label>
                            <input type="url" id="imagem" th:field="*{imageURL}" required />
                        </div>
                        <div class="image-preview">
                            <img id="previewImage" th:src="*{imageURL}" alt="Preview"
                                 th:if="*{imageURL != null}" style="max-width: 100%; height: auto;" />
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Adicionar Carro</button>
                    <button type="reset" class="btn btn-secondary">Limpar Formulário</button>
                </div>
            </form>
        </section>

        <!-- Gráficos Section -->
        <section id="graficos" class="section">
            <h2>Gráficos Mensais</h2>
            <div class="chart-container">
                <canvas id="salesChart"></canvas>
            </div>
        </section>
    </main>
</div>

<script>
    // Initialize charts
    document.addEventListener('DOMContentLoaded', function() {
        const ctx = document.getElementById('salesChart').getContext('2d');
        new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
                datasets: [{
                    label: 'Vendas Mensais',
                    data: [12, 19, 15, 25, 22, 30],
                    borderColor: '#007bff',
                    tension: 0.1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false
            }
        });
    });

    // Improved sidebar toggle functionality
    document.addEventListener('DOMContentLoaded', function() {
        const sidebar = document.querySelector('.sidebar');
        const mainContent = document.querySelector('.main-content');
        const toggleBtn = document.getElementById('toggleSidebar');

        // Check for saved state
        const isCollapsed = localStorage.getItem('sidebarCollapsed') === 'true';
        if (isCollapsed) {
            sidebar.classList.add('collapsed');
            mainContent.classList.add('expanded');
        }

        // Handle window resize
        function handleResize() {
            if (window.innerWidth <= 768) {
                sidebar.classList.add('collapsed');
                mainContent.classList.add('expanded');
            } else {
                // Restore saved state for larger screens
                const isCollapsed = localStorage.getItem('sidebarCollapsed') === 'true';
                if (isCollapsed) {
                    sidebar.classList.add('collapsed');
                    mainContent.classList.add('expanded');
                } else {
                    sidebar.classList.remove('collapsed');
                    mainContent.classList.remove('expanded');
                }
            }
        }

        // Initial check
        handleResize();

        // Add resize listener
        window.addEventListener('resize', handleResize);

        toggleBtn.addEventListener('click', function() {
            if (window.innerWidth <= 768) {
                sidebar.classList.toggle('expanded');
            } else {
                sidebar.classList.toggle('collapsed');
                mainContent.classList.toggle('expanded');
            }

            // Save state only for larger screens
            if (window.innerWidth > 768) {
                localStorage.setItem('sidebarCollapsed', sidebar.classList.contains('collapsed'));
            }
        });
    });

    // Sidebar navigation
    document.querySelectorAll('.sidebar-menu a').forEach(link => {
        link.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').substring(1);

            // Update active state
            document.querySelectorAll('.sidebar-menu a').forEach(a => a.classList.remove('active'));
            this.classList.add('active');

            // Show target section
            document.querySelectorAll('.section').forEach(section => {
                section.style.display = 'none';
            });
            document.getElementById(targetId).style.display = 'block';
        });
    });

    // Image preview functionality
    document.getElementById('imagem').addEventListener('input', function(e) {
        const preview = document.getElementById('previewImage');
        if (this.value) {
            preview.src = this.value;
            preview.style.display = 'block';
        } else {
            preview.style.display = 'none';
        }
    });

    /*
    // Form submission
    document.getElementById('novoCarroForm').addEventListener('submit', function(e) {
        e.preventDefault();

        // Collect form data
        const formData = new FormData(this);
        const carData = Object.fromEntries(formData.entries());

        // Here you would typically send the data to your backend
        console.log('Car data:', carData);

        // Show success message
        alert('Carro adicionado com sucesso!');
        this.reset();
        document.getElementById('previewImage').style.display = 'none';
    });*/

</script>
</body>

</html>